<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-releaselog/GeneralUpdateReleaselog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">GeneralUpdate | GeneralLibrary</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/en/docs/releaselog/releaselog"><meta data-rh="true" property="og:locale" content="en_GB"><meta data-rh="true" property="og:locale:alternate" content="zh_GB"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="GeneralUpdate | GeneralLibrary"><meta data-rh="true" name="description" content="📍2023-08-05"><meta data-rh="true" property="og:description" content="📍2023-08-05"><link data-rh="true" rel="icon" href="/en/img/general.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/en/docs/releaselog/releaselog"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/releaselog/releaselog" hreflang="zh-GB"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/en/docs/releaselog/releaselog" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/releaselog/releaselog" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.90edea34.css">
<script src="/en/assets/js/runtime~main.3d64de44.js" defer="defer"></script>
<script src="/en/assets/js/main.af474134.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/general.png" alt="GeneralLibrary Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/general.png" alt="GeneralLibrary Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GeneralLibrary</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/category/doc">文档</a><a class="navbar__item navbar__link" href="/en/EcologicalPartners">生态伙伴</a><a class="navbar__item navbar__link" href="/en/CooperativeEnterprises">企业合作</a><a class="navbar__item navbar__link" href="/en/About">关于</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/GeneralLibrary" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/releaselog/releaselog" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-GB">中文</a></li><li><a href="/en/docs/releaselog/releaselog" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/doc">Doc</a><button aria-label="Expand sidebar category &#x27;Doc&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/category/release-log">Release log</a><button aria-label="Collapse sidebar category &#x27;Release log&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/releaselog/releaselog">GeneralUpdate</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/category/release-log"><span itemprop="name">Release log</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">GeneralUpdate</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>📒更新日志</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-08-05">📍2023-08-05<a href="#2023-08-05" class="hash-link" aria-label="Direct link to 📍2023-08-05" title="Direct link to 📍2023-08-05">​</a></h2>
<p>在企业产品发布到市场之前需要对功能进行测试，在大部分公司里自动升级功  能不像产品功能一样有需求文档或者业务说明等文档。通常的要求就是能正常升级公司产品或能增量更新节约流量即可。这时候对测试经验不足的人员来说测试不充分或者大家都没有考虑到将会造成很多麻烦。（这里只是提供一种测试的思路，并非专业测试指导请辩证看待）</p>
<p>1.测试版本升级顺序</p>
<p>假设市场上所有的客户现在使用的程序版本是v1.0.0.0，我们即将发布v2.0.0.0。在发布之前就需要在测试环境中将两个版本升级测试一下。</p>
<ul>
<li>下载更新包时</li>
<li>正在更新文件时</li>
<li>强制中断程序运行、断网、直接断电、模拟弱网、模拟崩溃等</li>
</ul>
<p>2.加密文件无法升级</p>
<p>在GeneralUpdate中在两个版本中提取二进制差分更新补丁文件时，会出现加密文件无法被差分算法识别的情况这个时候需要考虑在生成差分补丁包时，将加密过的文件加入到（SetBlacklist）黑名单中或者考虑直接覆盖（直接打在压缩包里）。</p>
<p>3.失败回滚或者重新升级？</p>
<p>这方面也是企业中大家最在意的一点，自动升级虽然能带来诸多好处。但是升级失败会直接导致客户端根本没法使用这是非常致命的，后续我会考虑在GeneralUpdate中新增两种策略来解决这个问题。</p>
<ul>
<li>策略一</li>
</ul>
<p>升级之前将需要被更新的文件或目录进行备份，如果更新失败第二次启动则会将备份文件还原至原来的目录，并关闭自动升级的开关以防止文件还原之后再次进行自动升级。</p>
<ul>
<li>策略二</li>
</ul>
<p>这个是我内心中比较推荐的升级方式，因为自动升级程序的意义就是升级而不是回滚。目前初步的想法是新增遗言机制。为解决在更新时遇到异常情况，导致文件损坏更新的问题。1.每次更新完成，需返回给服务器更新状态。如果客户端在30分钟内没有任何反 馈则判定为毁坏性更新失败。（文件损坏）2.升级程序每次启动时会读取上一次更新的遗言，如果上次更新为失败自动化下载、安装客户端安装包（压缩包）3.或者新增更新守护进程接收实时推送自动化下载、安装客户端安装包（压缩包）</p>
<p>4.项目结构调整</p>
<p>如果开发人员对项目结构发生了一些结构性质的修改。例如基于IoC思想搭建的客户端程序，例如Prism框架如果开发人员把其中的一个Module更换了文件夹的位置或者文件夹名称修改了，导致用户的客户端更新了之后IoC容器启动之后找不到该DLL的异常情况。更新时需要考虑到文件路径变化的问题。测试人员也有责任例行询问是否有该种类的变化。</p>
<p>5.作为最后闭环流程再测试</p>
<p>这个事项是非常需要注意的，如果前面就把自动升级先测试了。如果后续有bug修复或者其他变动都有可能会造成未知的异常情况出现。所以作为最后的闭环流程进行测试是比较推荐的（如有特殊情况按需要调整即可）。</p>
<p>6.弱网环境测试</p>
<p>弱网环境模拟可以借助NetLimiter和Clumsy来进行测试，具体使用方法可以参考我的这篇文章。</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI5MTg4NzIyNg==&amp;mid=2247486705&amp;idx=1&amp;sn=b2eac543ea7f738bdbe8c3cc63da3488&amp;chksm=ec088de4db7f04f25e5603d2309d61279b0f94ee6eef34129801755a86cf406f863896214b3c&amp;token=1809721461&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s?__biz=MzI5MTg4NzIyNg==&amp;mid=2247486705&amp;idx=1&amp;sn=b2eac543ea7f738bdbe8c3cc63da3488&amp;chksm=ec088de4db7f04f25e5603d2309d61279b0f94ee6eef34129801755a86cf406f863896214b3c&amp;token=1809721461&amp;lang=zh_CN#rd</a></p>
<p>7.灰度发布</p>
<p>版本发布之前就需要做好测试。</p>
<ul>
<li>如果面对的客户群体庞大则需要小范围的灰度发布，如果没有问题  再选择发布给市场上所有客户。</li>
<li>如果是灰度升级版本，这个时候就不要设置为强制更新的版本了。让用户自己选择是否升级。</li>
</ul>
<p>8.精准升级</p>
<p>在GeneralUpdate中目前已有的基于Signal R接收推送最新版本更新的方式。假设在市场上有很多客户，每个客户有很多台设备。那么其中客户A有10台电脑，只有其中一台电脑因为硬件或者软件环境出现了问题导致客户端的功能异常。这个时候需要紧急针对该台设备的情况进行修复，这个时候并不清楚这个修改会不会对现在已经正常运行的客户端程序有影响。这个时候可以考虑使用一对一的升级方式精准升级某台出问题的电脑。</p>
<p>9.老配置兼容新版本</p>
<p>在市场上如果存在各个分支的版本时，每次自动更新升级还需要考虑到本地配置文件的问题。如果升级到新版本的程序之后需要读配置文件这个时候，老版本的配置文件兼容不了也会造成问题。这个时候测试人员也需要注意该种场景。</p>
<p>规避这种问题的方式可以把大部分容易变动的配置放到服务端每次登录的时候去读取。把不容易变化的配置保存到本地。</p>
<p>10.自动化测试</p>
<p>自动升级的自动测试化测试的脚本编写也非常重要，在多分支、多版本的升级测试中节省时间,增加测试的准确性。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-07-23">📍2023-07-23<a href="#2023-07-23" class="hash-link" aria-label="Direct link to 📍2023-07-23" title="Direct link to 📍2023-07-23">​</a></h2>
<p>开发者提问：</p>
<ul>
<li>（1）在更新过程中出现了断网、断电、电脑死机、突然蓝屏、程序假死等意外情况，导致应用程序无法正常进行更新或者无法正常启动如何解决？能否让更新程序回滚到这次更新之前？</li>
</ul>
<p>答：这个问题分两块回答，（1）意外情况可以尝 试重启应用程序断点下载更新，目前的情况来说如果在更新过程中出现文件损坏无法只能重新安装。后续会考虑增加一种机制处理更新异常情况无法启动客户端应用程序的问题。（2）不能，因为目前的想法来说自动升级程序的核心意义就是升级，如果回滚回去了升级可能就失去了意义。可能会希望及时发现问题，然后紧急更新一个安全的更新包让客户端逐版本更新直到成功。</p>
<ul>
<li>（2）如果更新包打包本身（更新包里本身就有异常文件）就有问题，更新完成之后程序无法正常启动。能不能回滚或者备份？</li>
</ul>
<p>答：不能，在该版本发布之前就需要做好测试。如果面对的客户群体庞大则需要小范围的灰度发布，如果没有问题再选择发布给市场上所有客户。</p>
<ul>
<li>（3）如果客户端本地保存了一些数据文件，在保留之前的数据的文件基础上需要新增一些内容，例如sqlite的.db文件更新之后被之前的.db文件被覆盖，如何解决？或者增量更新是否可以正常更新这些文件？</li>
</ul>
<p>答：之前有开发过这样的功能，效果不好暂时下线了；后续需要重新设计再启用该类功能。组件目前的功能完成度暂时无法解决这个问题，只能覆盖。增量更新也有极大的可能更新不了这种情况。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-04-23">📍2023-04-23<a href="#2023-04-23" class="hash-link" aria-label="Direct link to 📍2023-04-23" title="Direct link to 📍2023-04-23">​</a></h2>
<p>使用技术更新</p>
<p>黑名单功能，OSS新功能发布，针对windows和.NET MAUI Android 版本。修复了部分bug和重构了组件整体的事件管理通知机制。</p>
<p>1.发布内容</p>
<table><thead><tr><th>组件名称</th><th>版本号（old）</th><th>版本号（new）</th><th>状态</th></tr></thead><tbody><tr><td>GeneralUpdate.AspNetCore</td><td>1.4.1</td><td>-</td><td>-</td></tr><tr><td>GeneralUpdate.ClientCore</td><td>2.8.9</td><td>2.12.9</td><td>新版本</td></tr><tr><td>GeneralUpdate.Core</td><td>4.11.18</td><td>4.14.18</td><td>新版本</td></tr><tr><td>GeneralUpdate.Differential</td><td>1.3.0</td><td>1.4.1</td><td>新版本</td></tr><tr><td>GeneralUpdate.Zip</td><td>1.3.0</td><td>-</td><td>-</td></tr><tr><td>GeneralUpdate.Tool</td><td>2.2.5</td><td>2.3.5</td><td>新版本</td></tr><tr><td>GeneralUpdate.Single</td><td>1.0.0</td><td>-</td><td>-</td></tr><tr><td>GeneralUpdate.Maui.OSS</td><td>1.0.0</td><td>1.0.0</td><td>新版本</td></tr></tbody></table>
<p>【1】组件GeneralUpdate.ClientCore</p>
<p>1.新增OSS更新功能</p>
<p>2.新增黑名单功能</p>
<p>3.重构事件，添加事件管理机制</p>
<p>4.修复，增量包只能识别新增，不能识别删除</p>
<p>【2】组件GeneralUpdate.Core</p>
<p>1.新增OSS更新功能</p>
<p>2.重构事件，添加事件管理机制</p>
<p>3.修复，增量包只能识别新增，不能识别删除</p>
<p>【3】组件GeneralUpdate.Differential</p>
<p>1.修复，增量包只能识别新增，不能识别删除</p>
<p>2.1 组件GeneralUpdate.ClientCore、组件GeneralUpdate.Core改动</p>
<p>1.事件订阅机制重构之后不再使用event+=订阅方式，通过事件EventManger添加事件监听。对于开发者来说只需要轻微的代码修改即可适应新版本。对于组件本身而言减少大量的代码，组合优于继承。</p>
<p>2.添加黑名单管理SetBlacklist方法，可以设置不想更新的某个具体文件或者某个类型的文件，组件内置默认黑名单文件：<!-- -->Newtonsoft.Json.dll<!-- --> 默认黑名单文件扩展名：<!-- -->.json<!-- -->。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">           Task.Run(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //ClientStrategy该更新策略将完成1.自动升级组件自更新 2.启动更新组件 3.配置好ClientParameter无需再像之前的版本写args数组进程通讯了。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //generalClientBootstrap.Config(baseUrl, &quot;B8A7FADD-386C-46B0-B283-C9F963420C7C&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               var configinfo = GetWindowsConfiginfo();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               var generalClientBootstrap = await new GeneralClientBootstrap()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //单个或多个更新包下载通知事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerMultiDownloadProgress(OnMultiDownloadProgressChanged)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //单个或多个更新包下载速度、剩余下载事件、当前下载版本信息通知事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerMultiDownloadStatistics(OnMultiDownloadStatistics)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //单个或多个更新包下载完成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerMultiDownloadCompleted(OnMultiDownloadCompleted)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //完成所有的下载任务通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerMultiAllDownloadCompleted(OnMultiAllDownloadCompleted)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //下载过程出现的异常通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerMultiDownloadError(OnMultiDownloadError)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //整个更新过程出现的任何问题都会通过这个事件通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .AddListenerException(OnException)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .Config(configinfo)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .Option(UpdateOption.DownloadTimeOut, 60)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .Option(UpdateOption.Encoding, Encoding.Default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .Option(UpdateOption.Format, Format.ZIP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .Strategy&lt;WindowsStrategy&gt;()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //注入一个func让用户决定是否跳过本次更新，如果是强制更新则不生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .SetCustomOption(ShowCustomOption)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //默认黑名单文件：{ &quot;Newtonsoft.Json.dll&quot; } 默认黑名单文件扩展名：{ &quot;.patch&quot;, &quot;.7z&quot;, &quot;.zip&quot;, &quot;.rar&quot;, &quot;.tar&quot; , &quot;.json&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               //如果不需要扩展，需要重新传入黑名单集合来覆盖。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .SetBlacklist(GetBlackFiles(), GetBlackFormats())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .LaunchTaskAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          });</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>1.新增OSS功能</p>
<p>OSS的全称是对象存储服务（Object Storage Service），做服务端技术栈开发的小伙伴肯定对这个不陌生在各大云服务器厂商都会提供类似的服务,说简单点就是一个文件服务器。例如：阿里云OSS、腾讯云COS、华为云OBS，其实它们只是名字不一样功能服务都差不多。然后本更新组件新功能的实现思路非常相似那么就选择了OSS来为该功能命名，而且方便开发者一眼能get到这个功能的作用（需要使用组件GeneralUpdate.ClientCore、GeneralUpdate.Core）。</p>
<p>2.GeneralUpdate.OSS运行原理</p>
<p>1.准备version.json版本信息配置文件，更新文件（update.zip）更新文件和之前的打包方式一样。</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;PubTime&quot;: 1680443321,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Name&quot;: &quot;generalupdate.ossclient&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;MD5&quot;: &quot;9bf414990a67e74f11752d03f49b15d8&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Version&quot;: &quot;1.0.4&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Url&quot;: &quot;http://192.168.50.203/update.zip&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;PubTime&quot;: 1680444916,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Name&quot;: &quot;generalupdate.ossclient&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;MD5&quot;: &quot;JXC122DFXCZXZNMRFf11752d03f49b15d8&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Version&quot;: &quot;1.0.5&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Url&quot;: &quot;http://192.168.50.203/update2.zip&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.Client启动时直接请求OSS服务器或文件服务器，下载version.json文件。</p>
<p>3.下载到本地之后解析版本信息内容判断是否需要更新，如果将信息通过进程启动传递Upgrade（Client自我关闭）。</p>
<p>4.Upgrade启动之后直接去下载update.zip，下载到本地之后直接解压覆盖本地文件。</p>
<p>5.Upgrade更新完成之后把Client启动起来，自我关闭。更新结束。</p>
<p>GeneralUpdateOSS的功能和GeneralUpdateBootstrap功能对比来说，使用的门槛非常低如果公司对自动更新的要求不高的话可以使用这个功能。一句话概括这个功能就是下载version.json根据文件里的内容去逐版本下载更新包，下载下来之后直接解压更新就结束了。</p>
<p>3.快速启动</p>
<p>Client（主客户端）使用代码示例：</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Task.Run(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var url = &quot;http://192.168.50.203&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var appName = &quot;GeneralUpdate.Client&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var version = &quot;1.0.0.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var versionFileName = &quot;version.json&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ParamsOSS @params = new ParamsOSS(url, appName, version, versionFileName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await GeneralClientOSS.Start(@params);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Upgrade(升级助手)使用代码示例：</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private static void Main(string[] args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Task.Run(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //var url = &quot;http://192.168.50.203&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //var appName = &quot;GeneralUpdate.Client&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //var version = &quot;1.0.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //var versionFileName = &quot;version.json&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //SerializeUtil.Deserialize&lt;ParamsOSS&gt;(args[0]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     //ParamsOSS @params = new ParamsOSS(url, appName, version, versionFileName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ParamsOSS @params = SerializeUtil.Deserialize&lt;ParamsOSS&gt;(args[0]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     await GeneralUpdateOSS.Start&lt;OSSStrategy&gt;(@params,Encoding.Default);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4.事件通知订阅</p>
<p>在OSS的更新过程中，保留了更新事件的参数和之前一样。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//code...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GeneralUpdateOSS.AddListenerMultiDownloadStatistics(OnMultiDownloadStatistics);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private static void OnMultiDownloadStatistics(object sender, MultiDownloadStatisticsEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Console.WriteLine($&quot; {e.Speed} , {e.Remaining.ToShortTimeString()}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.3  .NET MAUI OSS</p>
<p>MAUI OSS功能介绍和 11.OSS中介绍的是一样的。但是它是针对.NET MAUI编写的更新，使用的组件库是GeneralUpdate.Maui.OSS。目前只实现了MAUI Andorid平台的自动更新。</p>
<p>1.准备version.json版本信息配置文件，更新文件（update.apk）更新文件就直接是新版本的apk了(或.abb)。</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;PubTime&quot;: 1680444916,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Name&quot;: &quot;com.companyname.generalupdate.ossclient&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;MD5&quot;: &quot;9bf414990a67e74f11752d03f49b15d8&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Version&quot;: &quot;1.0.5&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Url&quot;: &quot;http://192.168.50.203/com.companyname.generalupdate.ossclient.apk&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.Client启动时直接请求OSS服务器或文件服务器，下载version.json文件。</p>
<p>3.下载到本地之后解析版本信息内容，判断是否需要更新。</p>
<p>4.需要更新则下载update.apk。</p>
<p>5.下载完成之后执行安装，这一步就交给了安卓操作系统执行。执行完成之后运行新版本app。</p>
<p>2.快速启动</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//http://192.168.50.203/version.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string url = &quot;http://192.168.50.203&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string appName = &quot;MainApplication.exe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string currentVersion = &quot;1.1.1.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string versionFileName = &quot;versions.json&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GeneralUpdateOSS.AddListenerDownloadProcess(OnOSSDownload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GeneralUpdateOSS.AddListenerException(OnException);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await GeneralUpdateOSS.Start&lt;Strategy&gt;(new ParamsAndroid(url, appName, &quot;123456789&quot;, currentVersion, versionFileName));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.事件通知订阅</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GeneralUpdateOSS.AddListenerDownloadProcess(OnOSSDownload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GeneralUpdateOSS.AddListenerException(OnException);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void OnOSSDownload(object sender, OSSDownloadArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Console.WriteLine($&quot;{e.ReadLength},{e.TotalLength}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void OnException(object sender, ExceptionEventArgs exception)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Console.WriteLine(exception.Exception.Message);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>.NET MAUI Android 相关疑问处理引导文章</li>
</ol>
<p><a href="https://www.cnblogs.com/MASA/p/16612541.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/MASA/p/16612541.html</a></p>
<p><a href="https://learn.microsoft.com/zh-cn/dotnet/maui/android/deployment/?view=net-maui-7.0" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/zh-cn/dotnet/maui/android/deployment/?view=net-maui-7.0</a></p>
<p><a href="https://stackoverflow.com/questions/45940861/android-8-cleartext-http-traffic-not-permitted" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/45940861/android-8-cleartext-http-traffic-not-permitted</a></p>
<p><a href="https://note.youdao.com/ynoteshare/mobile.html?id=5c5d5cf8fe1d67419b09024255ff239c" target="_blank" rel="noopener noreferrer">https://note.youdao.com/ynoteshare/mobile.html?id=5c5d5cf8fe1d67419b09024255ff239c</a></p>
<p>5.运行效果</p>
<p>目前已运行测试机型、平台 。</p>
<p>1.在华为荣耀Px30非鸿蒙系统手机可运行。</p>
<p>2.Visual studio 2022 preview Pixe 5 - API33 (Android 13.0 - API 33) 可运行。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-01-17">📍2023-01-17<a href="#2023-01-17" class="hash-link" aria-label="Direct link to 📍2023-01-17" title="Direct link to 📍2023-01-17">​</a></h2>
<p>开源项目调整</p>
<p>在github和gitee的两个开源平台分别建立了General开源组织，会将具有一定代码贡献的小伙伴邀请到组织中来并分配奖励。</p>
<p>将原有的GeneralUpdate 拆分成了三个项目，分别是：</p>
<ul>
<li>
<p><a href="https://gitee.com/GeneralLibrary" target="_blank" rel="noopener noreferrer">https://gitee.com/GeneralLibrary</a></p>
</li>
<li>
<p>自动升级项目 <a href="https://gitee.com/GeneralLibrary/GeneralUpdate" target="_blank" rel="noopener noreferrer">https://gitee.com/GeneralLibrary/GeneralUpdate</a></p>
</li>
<li>
<p>差分补丁包打包工具 <a href="https://gitee.com/GeneralLibrary/GeneralUpdate.Tools" target="_blank" rel="noopener noreferrer">https://gitee.com/GeneralLibrary/GeneralUpdate.Tools</a></p>
</li>
<li>
<p>使用示例 <a href="https://gitee.com/GeneralLibrary/GeneralUpdate-Samples" target="_blank" rel="noopener noreferrer">https://gitee.com/GeneralLibrary/GeneralUpdate-Samples</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2022-10-09">📍2022-10-09<a href="#2022-10-09" class="hash-link" aria-label="Direct link to 📍2022-10-09" title="Direct link to 📍2022-10-09">​</a></h2>
<p>发布内容</p>
<table><thead><tr><th>组件名称</th><th>版本号（old）</th><th>版本号（new）</th><th>状态</th></tr></thead><tbody><tr><td>GeneralUpdate.AspNetCore</td><td>1.1.0</td><td>1.4.1</td><td>正常</td></tr><tr><td>GeneralUpdate.ClientCore</td><td>2.3.6</td><td>2.8.9</td><td>正常</td></tr><tr><td>GeneralUpdate.Core</td><td>4.10.12</td><td>4.11.18</td><td>正常</td></tr><tr><td>GeneralUpdate.Differential</td><td>1.0.0</td><td>1.3.0</td><td>正常</td></tr><tr><td>GeneralUpdate.Zip</td><td>1.0.0</td><td>1.3.0</td><td>正常</td></tr><tr><td>GeneralUpdate.Tool</td><td>1.0.0</td><td>2.1.5</td><td>正常</td></tr><tr><td>GeneralUpdate.Single</td><td>1.0.0</td><td>-</td><td>正常</td></tr></tbody></table>
<p>【1】组件GeneralUpdate.AspNetCore</p>
<p>（1）重构：将之前的version和validate方法合并为Update方法，将这一个方法完成版本验证和返回更新信息功能。</p>
<p>（2）新增：为配合GeneralUpdate.PacktTool自动上传发布功能，新增了upload方法。完成版本信息入库和更新包落文件服务器。</p>
<p>GeneralUpdate.AspNetCore组件添加文件上传接口 · Issue #I55NFC · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（3）新增：该方法是为了配合客户端即使推送重要版本或服务端服务之间的更新，新增的push调用一次之后会通过Signal R推送更新信息。</p>
<p>【2】组件GeneralUpdate.ClientCore</p>
<p>（1）修复：AutoUpdate.Core与AutoUpdate.ClientCore文件冲突问题 · Issue #I5F2YM · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（2）修复：更新组件无需更新报错 · Issue #I5F1VN · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（3）重构：更新机制需适配多个操作系统平台 · Issue #I5LYQZ · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（4）重构：重构版本验证机制 · Issue #I5LYQY · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（5） 新增：配置适应MAUI - Windows machice · Issue #I4TGJC · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（6）修复：当主程序已经是最新时，是不是应该先判断，这时候就不用启动升级软件吧？ · Issue #I5O53P · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（7）重构：</p>
<p>将</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public GeneralClientBootstrap Config(ClientParmeter info)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>修改为：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public GeneralClientBootstrap Config(Configinfo info)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>只是改变了类名称，字段内容删除validaterul和versionurl。</p>
<p>（8）新增：</p>
<p>用户自定义方法，决定是否跳过本次更新的Task版本方法。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public GeneralClientBootstrap SetCustomOption(Func&lt;Task&lt;bool&gt;&gt; func)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>（9）新增：</p>
<p>在更新配置中新增了枚举，将原来的字符串“.zip”修改为枚举Format.ZIP，防止用户输入字符串错误。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Option(UpdateOption.Format, Format.ZIP)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【3】组件GeneralUpdate.Core</p>
<p>（1）重构：更新机制需适配多个操作系统平台 · Issue #I5LYQZ · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（2）重构：重构版本验证机制 · Issue #I5LYQY · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（3）修复：当主程序已经是最新时，是不是应该先判断，这时候就不用启动升级软件吧？ · Issue #I5O53P · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（4）修复：BUG: &quot;GeneralUpdate.Core\Utils\FileUtil.cs&quot; GetFileMD5 函数异常 · Issue #I5J0KA · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（5）修复：多级文件夹结构更新失败问题 · Issue #I59QRI · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（6）新增：在更新体系中添加客户端唯一标识 · Issue #I55NFP · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（7）下线：json配置文件更新功能，将直接覆盖。等待重构完成再次上线。影响范围如下：</p>
<p>老哥，一点点建议 · Issue #I556BK · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>报错 · Issue #I53XYX · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（8）调研：可行。</p>
<p> 调研Mac环境下是否可以正常运行 · Issue #I4TGKK · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（9）修复：bug：&quot;GeneralUpdate\src\GeneralUpdate.Core\Download\AbstractTask.cs&quot; 第143行 · Issue #I4WQQ0 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>【4】组件GeneralUpdate.Differential</p>
<p>重构：递归查找需更新文件，防止一些文件没有更新检测到。添加树形结构管理更新文件目录结构。</p>
<p>修复：只能更新第一层文件bug，现在可以递归更新所有目录下的文件夹和子文件夹内的文件列表。</p>
<p>修复：打包工具打包文件包含两个名称相同但后缀不同的文件时会出错 · Issue #I5O4OD · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>【5】组件GeneralUpdate.Zip</p>
<p>（1）修复：关于文件压缩的几个问题 · Issue #I5J4Y6 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（2）修复：word文件乱码 · Issue #I5O4S6 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（3）修复：下载包解压在C盘下Program Files (x86)时，没有权限操作怎么处理？ · Issue #I4ZKQ4 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>【6】GeneralUpdate.PacketTool</p>
<p>（1）修复：打包工具打包时，没有考虑有子文件夹的问题 · Issue #I5O4P8 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（2）重构：重构文件功能体系 · Issue #I59Q5W · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（3）重构：打包工具迁移到MAUI · Issue #I5QOLG · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（4）新增：GeneralUpdate.Tool添加上传功能 · Issue #I55NF1 · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（5）修复：当只修改文件内容时，PacketTool打包功能无效 · Issue #I5BERJ · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>（6）修复：文件解压后中文名显示乱码 · Issue #I502QQ · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>【7】测试用例 、示例代码</p>
<p>示例代码：</p>
<p>src/c#/GeneralUpdate.Api/Program.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/GeneralUpdate.Client/MainPage.xaml.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/GeneralUpdate.Upgrad/Program.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>测试用例（还在完善）：</p>
<p>src/c#/TestClientCore/UnitTest1.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/TestDifferential/UnitTest1.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/TestMD5/UnitTest1.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/TestService/Program.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<p>src/c#/TestZIP/UnitTest1.cs · Juster.zhu/GeneralUpdate - Gitee.com</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2022-04-03">📍2022-04-03<a href="#2022-04-03" class="hash-link" aria-label="Direct link to 📍2022-04-03" title="Direct link to 📍2022-04-03">​</a></h2>
<p>（1）主程序和升级程序之间是否支持相互升级？</p>
<p>答：支持。</p>
<p>（2）是否需要开发者写代码关闭进程的时机或者其他代码？</p>
<p>答：不需要，组件已经将整个更新流程考虑到了。所以除了组件代码以外，不需要开发者额外多写任何辅助代码。</p>
<p>（3）更新程序是否需要和主程序放在同一个目录下？</p>
<p>答：是的，需要。但一定要保持升级程序不能引用主程序的里的任何代码。否则会更新失败。</p>
<p>（4）更新完成之后会删除更新包的补丁文件吗？</p>
<p>答：会的，组件更新完成之后会保证文件列表干净，不会出现冗余文件污染、磁盘空间占用的情况。</p>
<p>（5）可以运用在服务端吗？就是服务与服务之间的升级。</p>
<p>答：理论上支持的，作者没有实际这么使用过。据反馈有的小伙伴已经这么干了。本次分享是针对C/S架构的场景。</p>
<p>（6）怎么获取更新包的MD5码？</p>
<p>答：使用项目源码里的，AutoUpdate.MD5工程。</p>
<p>（7）怎么制作一个更新包？</p>
<p>答：使用GeneralUpdate.PacketTool工具生成即可。在源码仓库的release中可以看到打包好的安装程序。</p>
<p>（8）关于组件的其他内容如何了解到？</p>
<p>答：可以通过官方网站、或者相关Q群、以及我gitee或github的issue中与我交流。</p>
<p>（9）下载包解压在C盘下Program Files (x86)时，没有权限操作怎么处理？</p>
<p>答：<a href="https://gitee.com/Juster-zhu/GeneralUpdate/issues/I4ZKQ4" target="_blank" rel="noopener noreferrer">https://gitee.com/Juster-zhu/GeneralUpdate/issues/I4ZKQ4</a></p>
<p>（10）更新文件较小时，下载速度显示为：0B/S 。</p>
<p>答：<a href="https://gitee.com/Juster-zhu/GeneralUpdate/issues/I3POMG" target="_blank" rel="noopener noreferrer">https://gitee.com/Juster-zhu/GeneralUpdate/issues/I3POMG</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2022-03-23">📍2022-03-23<a href="#2022-03-23" class="hash-link" aria-label="Direct link to 📍2022-03-23" title="Direct link to 📍2022-03-23">​</a></h2>
<p>说明</p>
<ul>
<li>在线帮助文档：<a href="http://justerzhu.cn/" target="_blank" rel="noopener noreferrer">http://justerzhu.cn/</a>  （后续将会按组件拆分成对应的文档）</li>
<li>Nuget版本管理参考标准：<a href="https://docs.microsoft.com/zh-cn/nuget/concepts/package-versioning" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/nuget/concepts/package-versioning</a></li>
<li>应用程序集版本管理参考标准：<a href="https://docs.microsoft.com/zh-cn/dotnet/standard/assembly/versioning" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/dotnet/standard/assembly/versioning</a> （被组件更新的客户端程序，说通俗点就是你公司的产品；组件的操作将按照这个标准执行。）</li>
<li>本次版本发布会有很多改变，不是平滑升级（追求稳定或不想改动慎用）。本项目正在逐渐稳定后续将会平滑升级避免开发者再度修改。</li>
<li>如果发生“乌龙事件” 例如：发布更新包内容自身错误或更新过程中发生意外，不可回滚。目前解决方案（1）重新请求更新，（2）通过推送机制发送紧急修复版本更新包；来解决此类问题。</li>
<li>关于“不可回滚”这个问题，如果有更好的办法希望各位可以直接在issues中提出您的看法；目前社区中有两种声音（1）出现意外情况希望组件可以将本地程序回滚至原来的版本，保证哪怕更新失败也要用户可用。（2）更新组件的意义就是将组件推向新的版本让本次的版本发布有效，如果更新失败那么让它更新成功为止；只许前进不许退</li>
</ul>
<p>发布内容</p>
<p>这里先看看发布的版本号以及这次大版本的更新发生了哪些改动（共8个部分）。</p>
<table><thead><tr><th>组件名称</th><th>版本号（old）</th><th>版本号（new）</th><th>状态</th></tr></thead><tbody><tr><td>GeneralUpdate.AspNetCore</td><td>1.0.0</td><td>1.1.0</td><td>正常</td></tr><tr><td>GeneralUpdate.ClientCore</td><td>1.1.2</td><td>2.3.6</td><td>正常</td></tr><tr><td>GeneralUpdate.Core</td><td>3.6.10</td><td>4.10.12</td><td>正常</td></tr><tr><td>GeneralUpdate.Differential</td><td>-</td><td>1.0.0</td><td>正常</td></tr><tr><td>GeneralUpdate.Common</td><td>1.0.0</td><td>-</td><td>移除</td></tr></tbody></table>
<p>【1】组件GeneralUpdate.AspNetCore</p>
<p>（1）[NEW] 添加了最新版本推送功能，VersionHub对象。主要解决临时需要推送紧急修复重大bug的版本。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var builder = WebApplication.CreateBuilder(args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddSingleton&lt;IUpdateService, GeneralUpdateService&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.Services.AddSignalR();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var app = builder.Build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.MapHub&lt;VersionHub&gt;(&quot;/versionhub&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.Use(async (context, next) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   var hubContext = context.RequestServices.GetRequiredService&lt;IHubContext&lt;VersionHub&gt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   await CommonHubContextMethod((IHubContext)hubContext);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if (next != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       await next.Invoke();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async Task CommonHubContextMethod(IHubContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   await context.Clients.All.SendAsync(&quot;clientMethod&quot;, &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【2】组件GeneralUpdate.ClientCore</p>
<p>（1）[NEW] 在GeneralClientBootstrap中重载了配置方式，该方法简化为只需要传递远程服务器地址例如<a href="http://127.0.0.1" target="_blank" rel="noopener noreferrer">http://127.0.0.1</a> 和更新程序名称即可，简化了开发者需要关心的参数组件内自动获取。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public GeneralClientBootstrap Config(string url, string appName = &quot;AutoUpdate.Core&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>（2）[NEW] 添加了最新版本接收推送功能，VersionHub对象。主要解决临时需要接收紧急修复重大bug的版本，可以在GetMessage回调函数中可添加更新操作。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">VersionHub&lt;string&gt;.Instance.Subscribe($&quot;{ baseUrl }/{ hubName }&quot;, &quot;TESTNAME&quot;, new Action&lt;string&gt;(GetMessage));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【3】组件GeneralUpdate.Core</p>
<p>（1）[FIX] 修复下载中途断网，到达超时时间没有异常上抛问题。</p>
<p>（2）[REFACTOR] 重构多任务下载设计。</p>
<p>（3）[FIX] 修复FileUtil.Update32Or64Libs  在某些情况下会抛出异常。</p>
<p>（4）[REFACTOR] 重构默认更新策略设计。</p>
<p>（5）[NEW] 添加了最新版本接收推送功能，VersionHub对象。主要解决临时需要接收紧急修复重大bug的版本。开发者可以在GetMessage回调函数中可添加更新操作。</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">VersionHub&lt;string&gt;.Instance.Subscribe($&quot;{ baseUrl }/{ hubName }&quot;, &quot;TESTNAME&quot;, new Action&lt;string&gt;(GetMessage));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>（6）[NEW] 支持7z压缩包的解压功能。</p>
<p>（7）[REMOVE] 移除了GeneralUpdate.Core与GeneralUpdate.ClientCore 中重复代码，通用代码通过链接文件解决冗余问题。</p>
<p>（8）[NEW] 支持增量更新功能，例如：只更新了一个文件，那么就只将该文件打包。</p>
<p>（9）[NEW] 支持二进制差分功能，例如：temp.dll 发生了修改产生了新版本的文件，那么将会把temp.dll的新版本文件和老版本文件做一个差分。最后生成一个.patch的补丁文件，按照正常项目迭代那么这个.patch的补丁将会是kb级的。再配合7z的高压缩将更新包的大小做到目前状态下的极致节省流量和带宽占用。特别需要说明的是，如果在新版本中添加了新文件还是会将新增文件原封不动的打包到更新包中。</p>
<p>【4】组件[NEW]GeneralUpdate.Differential</p>
<p>在GeneralUpdate中新增组件Differential，该组件主要提供以下功能：</p>
<p>（1）[NEW] 新增二进制差分更新,生成.patch补丁文件。</p>
<p>（2）[NEW] 新增增量更新，例如：version 1.1.1.1原有10个文件这次版本发布修改了其中3个文件那么只会将修改的文件进行打包。</p>
<p>（3）[NEW] 更新配置文件（目前只支持.json配置文件且内容深度为1级），例如：客户端程序使用.json格式文件作为配置文件，那么将会保留客户端原有配置内容的前提下更新配置文件内容。假设客户端原有配置文件（.json）中包含内容：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;ip&quot;:&quot;123456789&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;port&quot;:9999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>服务端新的配置文件结构为：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;ip&quot;:&quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;port&quot;:0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;path&quot;:&quot;c://&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那么将会把，“path”字段更新到客户端本地配置文件中并保留原有内容为：</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;ip&quot;:&quot;123456789&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;port&quot;:9999,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;path&quot;:&quot;c://&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>【5】组件GeneralUpdate.Zip</p>
<p>（1）[REFACTOR] 重构压缩组件设计，将支持.zip和.7z压缩包格式。</p>
<p>（2）[NEW] 添加7z解压功能。</p>
<p>【6】组件[REMOVE]GeneralUpdate.Common</p>
<p>（1）移除该组件，解除GeneralUpdate.Core与GeneralUpdate.ClientCore 耦合，发现目前版本并不需要。</p>
<p>【7】组件GeneralUpdate.Single</p>
<p>本次未更新实际功能。</p>
<p>【8】测试用例 Example</p>
<p>为简化开发者在验证、测试过程中编写用例开发工作。在GeneralUpdate解决方案中添加了以下测试用例：</p>
<ul>
<li>AutoUpdate.ClientCore</li>
<li>AutoUpdate.Core</li>
<li>AutoUpdate.MD5</li>
<li>AutoUpdate.Differential</li>
<li>AutoUpdate.ZIP</li>
<li>AutoUpdate.MinimalService</li>
<li>AutoUpdate.Test</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2022-02-16">📍2022-02-16<a href="#2022-02-16" class="hash-link" aria-label="Direct link to 📍2022-02-16" title="Direct link to 📍2022-02-16">​</a></h2>
<p>目前框架支持</p>
<p>理论支撑：<a href="https://docs.microsoft.com/zh-cn/dotnet/standard/net-standard" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/dotnet/standard/net-standard</a></p>
<table><thead><tr><th>框架名称</th><th>是否支持</th></tr></thead><tbody><tr><td>.NET Core 2.0</td><td>支持</td></tr><tr><td>.NET 5 6 7</td><td>支持</td></tr><tr><td>.NET Framework 4.6.1</td><td>支持</td></tr><tr><td>Mono 5.4</td><td>理论支持，未验证</td></tr><tr><td>Xamarin.iOS</td><td>理论支持，未验证</td></tr><tr><td>Xamarin.Mac</td><td>理论支持，未验证</td></tr><tr><td>Xamarin.Android</td><td>理论支持，未验证</td></tr><tr><td>Universal Windows Platform 10.0.16299</td><td>理论支持，未验证</td></tr><tr><td>Unity 2018.1</td><td>理论支持，未验证</td></tr></tbody></table>
<table><thead><tr><th>UI框架名称</th><th>是否支持</th></tr></thead><tbody><tr><td>WPF</td><td>支持</td></tr><tr><td>UWP</td><td>未验证，等待反馈</td></tr><tr><td>MAUI</td><td>暂不支持，正在兼容</td></tr><tr><td>Avalonia</td><td>未验证，等待反馈</td></tr><tr><td>WinUI</td><td>未验证，等待反馈</td></tr><tr><td>Console（控制台）</td><td>支持</td></tr></tbody></table>
<table><thead><tr><th>操作系统名称</th><th>是否支持</th></tr></thead><tbody><tr><td>Windows</td><td>支持</td></tr><tr><td>Linux</td><td>未验证</td></tr><tr><td>Mac</td><td>未验证</td></tr><tr><td>iOS</td><td>暂不支持</td></tr><tr><td>Android</td><td>暂不支持</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2021-08-14">📍2021-08-14<a href="#2021-08-14" class="hash-link" aria-label="Direct link to 📍2021-08-14" title="Direct link to 📍2021-08-14">​</a></h2>
<p>Notice</p>
<ul>
<li>预计会使用Blazor开发GeneralUpdate官网，介绍组件结构、更新流程、快速启动、参数等内容。</li>
</ul>
<p><img decoding="async" loading="lazy" alt="图片" src="/en/assets/images/udpate_flow-51ecc46ab61de46341e4dfb5fcaf55d8.jpg" width="1080" height="552" class="img_ev3q"></p>
<p>1.主程序启动时检测升级程序是否需要更新
2.需要更新则把升级程序版本号上传并逐版本更新
3.升级程序更完成后或不需要更新，则进行判断主程序
是否需要更新如果需要更新则启动升级程序
4.请求主程序更新版本
5.请求到主版本多个更新包并逐版本更新
6.更新完成后关闭升级程序启动主程序</p>
<p><img decoding="async" loading="lazy" alt="图片" src="/en/assets/images/supporting_relationships-e3d967e02fc0a401120ac55b837a7db1.jpg" width="1080" height="577" class="img_ev3q"></p>
<ul>
<li>以上更新、下载过程均支持断点续传和逐版本更新。</li>
<li>逐版本下载功能是根据版本发布时间进行排序的发布时间越早的版本越先更新（具体信息见源码中的sql脚本字段内容）。</li>
<li>逐版本下载的更新包最大测试过1G更新内容。</li>
</ul>
<p>2.Nuget</p>
<ul>
<li>(New)<a href="https://www.nuget.org/packages/GeneralUpdate.Common/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.Common/</a></li>
<li>(New)<a href="https://www.nuget.org/packages/GeneralUpdate.ClientCore/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.ClientCore/</a></li>
<li>(New)<a href="https://www.nuget.org/packages/GeneralUpdate.AspNetCore/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.AspNetCore/</a></li>
<li><a href="https://www.nuget.org/packages/GeneralUpdate.Zip/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.Zip/</a></li>
<li><a href="https://www.nuget.org/packages/GeneralUpdate.Single/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.Single/</a></li>
<li>(Update)<a href="https://www.nuget.org/packages/GeneralUpdate.Core/" target="_blank" rel="noopener noreferrer">https://www.nuget.org/packages/GeneralUpdate.Core/</a></li>
</ul>
<p>3.Issues &amp; Git 、Gitee</p>
<p>欢迎在以下地址提出issues提出时尽可能的描述清楚异常发生的原因或缺陷详情，check周期为每周的周五。</p>
<ul>
<li><a href="https://gitee.com/Juster-zhu/GeneralUpdate" target="_blank" rel="noopener noreferrer">https://gitee.com/Juster-zhu/GeneralUpdate</a></li>
<li><a href="https://github.com/WELL-E/AutoUpdater/tree/autoupdate2" target="_blank" rel="noopener noreferrer">https://github.com/WELL-E/AutoUpdater/tree/autoupdate2</a></li>
<li><a href="https://github.com/WELL-E/AutoUpdater/issues" target="_blank" rel="noopener noreferrer">https://github.com/WELL-E/AutoUpdater/issues</a></li>
<li><a href="https://gitee.com/Juster-zhu/GeneralUpdate/issues" target="_blank" rel="noopener noreferrer">https://gitee.com/Juster-zhu/GeneralUpdate/issues</a></li>
</ul>
<p>4.New</p>
<ul>
<li>GeneralUpdate.Core添加逐版本更新功能</li>
<li>GeneralUpdate.Core新增事件ExceptionEvent、MutiDownloadStatisticsEvent、MutiDownloadErrorEvent、MutiDownloadCompletedEvent、MutiDownloadProgressEvent、MutiAllDownloadCompletedEvent。</li>
<li>GeneralUpdate.Core新增RemoteAddressBase64方法。</li>
<li>新增ClientParameter类，用于组件之间进程通讯传递参数。</li>
<li>新增组件GeneralUpdate.AspNetCore,具有根据升级类型返回更新版本信息的功能并支持管道依赖注入使用，但需要自己编写查库的方法。</li>
<li>新增组件GeneralUpdate.ClientCore,<!-- -->
<ul>
<li>(1)具有更新升级组件版本功能（更新程序更新自己）</li>
<li>(2)支持升级组件的逐版本更新(多更新包同时下载)</li>
<li>(3)便捷启动升级程  序，摆脱之前的繁琐进程启动和传参。</li>
</ul>
</li>
<li>新增组件GeneralUpdate.Common 该库整合了组件内使用的所有公共类和辅助方法（该组件为必须组件，该组件更新频率非常低不推荐打包在更新包中）。</li>
<li>新增mysql脚本，用于创建GeneralUpdate.AspNetCore服务端使用的update_version表。</li>
</ul>
<p>5.Remove</p>
<ul>
<li>移除GeneralUpdate.Core中所有的通知事件替换为MutixxxxEvent.</li>
<li>移除GeneralUpdate.Core中GeneralUpdateBootstrap启动中通过进程传递参数的方法RemoteAddress方法。</li>
<li>移除更新失败版本回滚功能，该功能导致在C盘回滚更新时因权限不够发生致命异常问题，该功能考虑后续开放。</li>
</ul>
<p>6.Fix</p>
<ul>
<li>修复https ssl访问失败问题。</li>
<li>修复其他.net框架版本注册事件begininvoke通知异常问题。</li>
<li>修改多处类名单词拼写错误问题。</li>
<li>对若干Model类删除了不必要字段。</li>
</ul>
<p>7.Quick Start</p>
<p><strong>（1） Example GeneralUpdate.ClientCore</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">            //Clinet version.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var mainVersion = &quot;1.1.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var mianType = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //Updater version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter = new ClientParameter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.ClientVersion = &quot;1.1.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.ClientType = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.AppName = &quot;AutoUpdate.ConsoleApp&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.MainAppName = &quot;AutoUpdate.Test&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.InstallPath = @&quot;D:\update_test&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.UpdateLogUrl = &quot;https://www.baidu.com/&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.ValidateUrl = $&quot;https://127.0.0.1:5001/api/update/getUpdateValidate/{ clientParameter.ClientType }/{ clientParameter.ClientVersion }&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.UpdateUrl = $&quot;https://127.0.0.1:5001/api/update/getUpdateVersions/{ clientParameter.ClientType }/{ clientParameter.ClientVersion }&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.MainValidateUrl = $&quot;https://127.0.0.1:5001/api/update/getUpdateValidate/{ mianType }/{ mainVersion }&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            clientParameter.MainUpdateUrl = $&quot;https://127.0.0.1:5001/api/update/getUpdateVersions/{ mianType }/{ mainVersion }&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap = new GeneralClientBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.MutiDownloadProgressChanged += OnMutiDownloadProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.MutiDownloadStatistics += OnMutiDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.MutiDownloadCompleted += OnMutiDownloadCompleted;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.MutiAllDownloadCompleted += OnMutiAllDownloadCompleted;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.MutiDownloadError += OnMutiDownloadError;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.Exception += OnException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            generalClientBootstrap.Config(clientParameter).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Strategy&lt;ClientStrategy&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await generalClientBootstrap.LaunchTaskAsync();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>（2） Example GeneralUpdate.Core</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    static void Main(string[] args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var resultBase64 = args[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var bootstrap = new GeneralUpdateBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.Exception += OnException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.MutiDownloadError += OnMutiDownloadError;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.MutiDownloadCompleted += OnMutiDownloadCompleted;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.MutiDownloadStatistics += OnMutiDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.MutiDownloadProgressChanged += OnMutiDownloadProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.MutiAllDownloadCompleted += OnMutiAllDownloadCompleted;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.Strategy&lt;DefaultStrategy&gt;().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.DownloadTimeOut, 60).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RemoteAddressBase64(resultBase64).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            LaunchAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>（3） Example GeneralUpdate.AspNetCore</strong></p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    Startup.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void ConfigureServices(IServiceCollection services)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        services.AddControllers();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        services.AddSingleton&lt;IUpdateService, GeneralUpdateService&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UpdateController.cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger&lt;UpdateController&gt; _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IUpdateService _updateService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public UpdateController(ILogger&lt;UpdateController&gt; logger, IUpdateService updateService)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _updateService = updateService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// https://localhost:5001/api/update/getUpdateVersions/1/1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;param name=&quot;clientType&quot;&gt; 1:ClientApp 2:UpdateApp&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;param name=&quot;clientVersion&quot;&gt;&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;returns&gt;&lt;/returns&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpGet(&quot;getUpdateVersions/{clientType}/{clientVersion}&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetUpdateVersions(int clientType, string clientVersion)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger.LogInformation(&quot;Client request &#x27;GetUpdateVersions&#x27;.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var resultJson = await _updateService.UpdateVersionsTaskAsync(clientType, clientVersion, UpdateVersions);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Ok(resultJson);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// https://localhost:5001/api/update/getUpdateValidate/1/1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;param name=&quot;clientType&quot;&gt; 1:ClientApp 2:UpdateApp&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;param name=&quot;clientVersion&quot;&gt;&lt;/param&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /// &lt;returns&gt;&lt;/returns&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [HttpGet(&quot;getUpdateValidate/{clientType}/{clientVersion}&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;IActionResult&gt; GetUpdateValidate(int clientType, string clientVersion)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger.LogInformation(&quot;Client request &#x27;GetUpdateValidate&#x27;.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var lastVersion = GetLastVersion();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var resultJson = await _updateService.UpdateValidateTaskAsync(clientType, clientVersion, lastVersion, true, GetValidateInfos);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Ok(resultJson);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2021-03-18">📍2021-03-18<a href="#2021-03-18" class="hash-link" aria-label="Direct link to 📍2021-03-18" title="Direct link to 📍2021-03-18">​</a></h2>
<p>声明</p>
<ol>
<li>本组件将支持以下框架开发的应用程序。.NET Framework 4.6.1 | .NET Core 2.0 | .NET 5</li>
<li>GeneralUpdate.Single组件目前仅支持wpf和.NET Framework框架。</li>
</ol>
<p>新增</p>
<ol>
<li>GeneralUpdate.Core-3.2.1版本，新增更新失败回滚功能。</li>
<li>新增了组件 GeneralUpdate.Zip-1.0.0，它将为程序带来压缩文件和解压压缩包的功能且能独立使用。</li>
</ol>
<p>修复、修改</p>
<ol>
<li>修复事件多线程操作时，不通知问题。</li>
<li>组件的框架版本从.NET Framework4.5.2修改为.net standard 2.0。（支持框架参考：<a href="https://docs.microsoft.com/zh-cn/dotnet/standard/net-standard%EF%BC%89" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/zh-cn/dotnet/standard/net-standard）</a></li>
</ol>
<p>移除</p>
<ol>
<li>移除7zip第三方组件的依赖</li>
<li>移除RegistryUtil工具类</li>
</ol>
<p>GeneralUpdate Quick start</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        args = new string[6] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;0.0.0.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;1.1.1.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;https://github.com/WELL-E&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             &quot;http://192.168.50.225:7000/update.zip&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             @&quot;E:\PlatformPath&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;509f0ede227de4a662763a4abe3d8470&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.DownloadStatistics += OnDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.ProgressChanged += OnProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.Strategy&lt;DefultStrategy&gt;().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.Format, &quot;zip&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.MainApp, &quot;your application name&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.DownloadTimeOut,60).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RemoteAddress(args).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Launch();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2020-08-30">📍2020-08-30<a href="#2020-08-30" class="hash-link" aria-label="Direct link to 📍2020-08-30" title="Direct link to 📍2020-08-30">​</a></h2>
<p>新增内容</p>
<ol>
<li>在新的发布中，GeneralUpdate.Core-2.1.0版本新增断点续传功能。</li>
<li>在新的发布中，新增了组件 GeneralUpdate.Single-1.0.0，它将为程序带来单例运行功能，防止自动更新程序开启多个。</li>
</ol>
<p>更新流程</p>
<p>1.客户端程序启动，向服务器获取更新信息解析并比对是否需要更新。</p>
<p>2.解析进程传参。例如：本机版本号、最新版本号、下载地址、解压路径、安装路径等。</p>
<p>3.客户端程序启动更新程序（GeneralUpdate），关闭自身（客户端把自己关掉）。</p>
<p>4.自动更新程序（GeneralUpdate）根据传递的更新信息进行， （1）下载、（2）MD5校验、（3）解压、（4）删除更新文件、（5）替 换更新文件、（6）关闭更新程序自身、（7）启动客户端。</p>
<p>5.完成更新</p>
<p>进程之间相互调用</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Diagnostics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.ComponentModel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace MyProcessSample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    class MyProcess</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //此段代码来自于msdn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Opens the Internet Explorer application.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void OpenApplication(string myFavoritesPath)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Start Internet Explorer. Defaults to the home page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(&quot;IExplore.exe&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Display the contents of the favorites folder in the browser.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(myFavoritesPath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Opens urls and .html documents using Internet Explorer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void OpenWithArguments()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // url&#x27;s are not considered documents. They can only be opened</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // by passing them as arguments.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(&quot;IExplore.exe&quot;, &quot;www.northwindtraders.com&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Start a Web page using a browser associated with .html and .asp files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(&quot;IExplore.exe&quot;, &quot;C:\\myPath\\myFile.htm&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(&quot;IExplore.exe&quot;, &quot;C:\\myPath\\myFile.asp&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Uses the ProcessStartInfo class to start new processes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // both in a minimized mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void OpenWithStartInfo()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ProcessStartInfo startInfo = new ProcessStartInfo(&quot;IExplore.exe&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            startInfo.WindowStyle = ProcessWindowStyle.Minimized;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(startInfo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            startInfo.Arguments = &quot;www.northwindtraders.com&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Process.Start(startInfo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        static void Main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Get the path that stores favorite links.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            string myFavoritesPath =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Environment.GetFolderPath(Environment.SpecialFolder.Favorites);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MyProcess myProcess = new MyProcess();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            myProcess.OpenApplication(myFavoritesPath);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            myProcess.OpenWithArguments();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            myProcess.OpenWithStartInfo();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>GeneralUpdate.Core-2.1.0使用方式</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> #region Launch1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> args = new string[6] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;0.0.0.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;1.1.1.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;https://github.com/WELL-E&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             &quot;http://192.168.50.225:7000/update.zip&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             @&quot;E:\PlatformPath&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;509f0ede227de4a662763a4abe3d8470&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();//自动更新引导类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.DownloadStatistics += OnDownloadStatistics;//下载进度通知事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.ProgressChanged += OnProgressChanged;//更新进度通知事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bootstrap.Strategy&lt;DefultStrategy&gt;().//注册策略，可自定义更新流程</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.Format, &quot;zip&quot;).//指定更新包的格式，目前只支持zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.MainApp, &quot;your application name&quot;).//指定更新完成后需要启动的主程序名称不需要加.exe直接写名称即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Option(UpdateOption.DownloadTimeOut,60).//下载超时时间（单位：秒）,如果不指定则默认超时时间为30秒。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            RemoteAddress(args).//这里的参数保留了之前的参数数组集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Launch();//启动更新</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #region Launch2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * Launch2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 新增了第二种启动方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 流程：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 1.指定更新地址，https://api.com/GeneralUpdate?version=1.0.0.1 在webapi中传入客户端当前版本号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 2.如果需要更新api返回给你所有的更新信息（详情内容参考 /Models/UpdateInfo.cs）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 3.拿到更新信息之后则开始http请求更新包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 4.下载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 5.解压</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 6.更新本地文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 7.关闭更新程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 8.启动配置好主程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         * 更新程序必须跟主程序放在同级目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //GeneralUpdateBootstrap bootstrap2 = new GeneralUpdateBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //bootstrap2.DownloadStatistics += OnDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //bootstrap2.ProgressChanged += OnProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //bootstrap2.Strategy&lt;DefultStrategy&gt;().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //    Option(UpdateOption.Format, &quot;zip&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //    Option(UpdateOption.MainApp, &quot;&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		//	  Option(UpdateOption.DownloadTimeOut,60).//下载超时时间（单位：秒）,如果不指定则默认超时时间为30秒。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //    RemoteAddress(@&quot;https://api.com/GeneralUpdate?version=1.0.0.1&quot;).//指定更新地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //    Launch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void OnProgressChanged(object sender, ProgressChangedEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (e.Type == ProgressType.Updatefile)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var str = $&quot;当前更新第：{e.ProgressValue}个,更新文件总数：{e.TotalSize}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Console.WriteLine(str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (e.Type == ProgressType.Done)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Console.WriteLine(&quot;更新完成&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void OnDownloadStatistics(object sender, DownloadStatisticsEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Console.WriteLine($&quot;下载速度：{e.Speed}，剩余时间：{e.Remaining.Minute}:{e.Remaining.Second}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>GeneralUpdate.Single-1.0.0使用方式</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// App.xaml 的交互逻辑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public partial class App : Application, ISingleInstanceApp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private const string AppId = &quot;{7F280539-0814-4F9C-95BF-D2BB60023657}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [STAThread]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override void OnStartup(StartupEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string[] resultArgs = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (e.Args == null || e.Args.Length == 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            resultArgs = new string[6] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;0.0.0.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;1.1.1.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;https://github.com/WELL-E&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             &quot;http://192.168.50.225:7000/update.zip&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             @&quot;E:\PlatformPath&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;509f0ede227de4a662763a4abe3d8470&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            resultArgs = e.Args;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (resultArgs.Length != 6) return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (SingleInstance&lt;App&gt;.InitializeAsFirstInstance(AppId))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var win = new MainWindow();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var vm = new MainViewModel(resultArgs, win.Close);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            win.DataContext = vm;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var application = new App();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            application.InitializeComponent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            application.Run(win);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            SingleInstance&lt;App&gt;.Cleanup();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public bool SignalExternalCommandLineArgs(IList&lt;string&gt; args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (this.MainWindow.WindowState == WindowState.Minimized)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.MainWindow.WindowState = WindowState.Normal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.MainWindow.Activate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>问答Q&amp;A</p>
<p>1.如果版本迭代多次，跨版本更新，该怎么办呢？</p>
<p>​      只要不是框架级别的更新都是可以更新的。不管你迭代多少次跨了多少个版本，你把最终的包放到服务器上就行了。这个里面没有涉及到增量更新，所以你更新多了直接把所有的新文件覆盖上去就行了。</p>
<p>2.GeneralUpdate是跟客户端是一个整体吗？</p>
<p>​      不是，GeneralUpdate是一个独立于客户端的程序。</p>
<p>3.能不能增量更新、失败自动回滚、更新本地数据或配置文件?</p>
<p>​      目前不能。（该功能已在开发计划当中）。</p>
<p>4.GeneralUpdate是如何更新的?</p>
<p>​      更新的方式为把本地原有的客户端文件进行覆盖。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2020-05-03">📍2020-05-03<a href="#2020-05-03" class="hash-link" aria-label="Direct link to 📍2020-05-03" title="Direct link to 📍2020-05-03">​</a></h2>
<p>1.简洁启动代码 如下：Launch1 Launch2</p>
<table><thead><tr><th>名称</th><th>类型</th><th>备注</th></tr></thead><tbody><tr><td>UpdateOption.Format</td><td>配置参数</td><td>更新包的压缩格式（目前只支持zip）</td></tr><tr><td>UpdateOption.MainApp</td><td>配置参数</td><td>更新完成后需要启动的主程序名称</td></tr><tr><td>DownloadStatistics</td><td>事件</td><td>更新包下载通知事件</td></tr><tr><td>ProgressChanged</td><td>事件</td><td>更新进度通知事件</td></tr><tr><td>Strategy()</td><td>方法</td><td>策略注入</td></tr><tr><td>RemoteAddress（）</td><td>方法</td><td>远程地址配置，如果没有 则传入args[]</td></tr><tr><td>Launch</td><td>方法</td><td>启动更新</td></tr><tr><td>GeneralUpdateBootstrap</td><td>类</td><td>更新引导类</td></tr></tbody></table>
<p>2.新增Strategy（更新策略），更新策略是开放出来让大家可以在不改动源码的情况下自由扩展更新方式将不会仅限于默认的更新策略。</p>
<p>3.更新本地文件时，会有更新通知事件。明确的告知更新文件总数和当前更新到第几个文件</p>
<p>4.新增更新状态 Check（检查更新），Donwload（下载更新包），Updatefile（更新文件），Done（更新完成），Fail（更新失败）。开发者可以直接通过一系列枚举值直接判断当前运行状态做出相应的处理</p>
<p>5.新增若干启动配置参数的验证</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if (args != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (args.Length == 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new NullReferenceException(&quot;Args does not contain any elements.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (args.Length &gt; elementNum)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new Exception($&quot;The number of args cannot be greater than { elementNum }&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (string.IsNullOrWhiteSpace(PacketName))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new NullReferenceException(&quot;packet name not set&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (string.IsNullOrWhiteSpace(DownloadPath))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new NullReferenceException(&quot;download path not set&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (string.IsNullOrWhiteSpace(InstallPath))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new NullReferenceException(&quot;install path not set&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (string.IsNullOrWhiteSpace(MD5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new NullReferenceException(&quot;install path not set&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>6.下载更新进度通知事件，将会提供剩余下载时间（Remaining）和下载速度（Speed）</p>
<div class="language-c# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c# codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">           #region Launch1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            args = new string[6] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;0.0.0.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;1.1.1.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;https://github.com/WELL-E&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 &quot;http://192.168.50.225:7000/update.zip&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 @&quot;E:\PlatformPath&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;509f0ede227de4a662763a4abe3d8470&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            GeneralUpdateBootstrap bootstrap = new GeneralUpdateBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bootstrap.DownloadStatistics += OnDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bootstrap.ProgressChanged += OnProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bootstrap.Strategy&lt;DefultStrategy&gt;().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Option(UpdateOption.Format, &quot;zip&quot;).//指定更新包的格式，目前只支持zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Option(UpdateOption.MainApp, &quot;your application name&quot;).//指定更新完成后需要启动的主程序名称不需要加.exe直接写名称即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                RemoteAddress(args).//这里的参数保留了之前的参数数组集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Launch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #region Launch2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * Launch2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 新增了第二种启动方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 流程：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 1.指定更新地址，https://api.com/GeneralUpdate?version=1.0.0.1 在webapi中传入客户端当前版本号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 2.如果需要更新api返回给你  所有的更新信息（详情内容参考 /Models/UpdateInfo.cs）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 3.拿到更新信息之后则开始http请求更新包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 4.下载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 5.解压</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 6.更新本地文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 7.关闭更新程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 8.启动配置好主程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             * 更新程序必须跟主程序放在同级目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //GeneralUpdateBootstrap bootstrap2 = new GeneralUpdateBootstrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //bootstrap2.DownloadStatistics += OnDownloadStatistics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //bootstrap2.ProgressChanged += OnProgressChanged;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //bootstrap2.Strategy&lt;DefultStrategy&gt;().</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //    Option(UpdateOption.Format, &quot;zip&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //    Option(UpdateOption.MainApp, &quot;KGS.CPP&quot;).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //    RemoteAddress(@&quot;https://api.com/GeneralUpdate?version=1.0.0.1&quot;).//指定更新地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //    Launch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            #endregion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private static void OnProgressChanged(object sender, ProgressChangedEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (e.Type == ProgressType.Updatefile)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                var str = $&quot;当前更新第：{e.ProgressValue}个,更新文件总数：{e.TotalSize}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Console.WriteLine(str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (e.Type == ProgressType.Done)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Console.WriteLine(&quot;更新完成&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private static void OnDownloadStatistics(object sender, DownloadStatisticsEventArgs e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Console.WriteLine($&quot;下载速度：{e.Speed}，剩余时间：{e.Remaining.Minute}:{e.Remaining.Second}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/en/docs/tags/log">log</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/GeneralLibrary/GeneralUpdate-Samples/tree/main/website/doc/docs/releaselog/GeneralUpdateReleaselog.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/category/release-log"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Release log</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#2023-08-05" class="table-of-contents__link toc-highlight">📍2023-08-05</a></li><li><a href="#2023-07-23" class="table-of-contents__link toc-highlight">📍2023-07-23</a></li><li><a href="#2023-04-23" class="table-of-contents__link toc-highlight">📍2023-04-23</a></li><li><a href="#2023-01-17" class="table-of-contents__link toc-highlight">📍2023-01-17</a></li><li><a href="#2022-10-09" class="table-of-contents__link toc-highlight">📍2022-10-09</a></li><li><a href="#2022-04-03" class="table-of-contents__link toc-highlight">📍2022-04-03</a></li><li><a href="#2022-03-23" class="table-of-contents__link toc-highlight">📍2022-03-23</a></li><li><a href="#2022-02-16" class="table-of-contents__link toc-highlight">📍2022-02-16</a></li><li><a href="#2021-08-14" class="table-of-contents__link toc-highlight">📍2021-08-14</a></li><li><a href="#2021-03-18" class="table-of-contents__link toc-highlight">📍2021-03-18</a></li><li><a href="#2020-08-30" class="table-of-contents__link toc-highlight">📍2020-08-30</a></li><li><a href="#2020-05-03" class="table-of-contents__link toc-highlight">📍2020-05-03</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Doc</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/doc/Component Introduction">GeneralLibrary</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/GeneralLibrary" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/GeneralLibrary" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/GeneralLibrary" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/GeneralLibrary" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juster zhu Project, Inc.</div></div></div></footer></div>
</body>
</html>